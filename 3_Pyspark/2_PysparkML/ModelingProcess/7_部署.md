```python
# 获取字段名及其类型
df = spark.table('fbidm.yuanjie_deploy_features_20180108')
strColName = [i for i, j in df.dtypes if j == 'string' and i != 'acct_no']
numColName = [i for i, j in df.dtypes if j not in strColName + ['acct_no', 'label']]

dfs = [spark.table('finance.mls_member_lab_info').withColumn('id', concat_ws('|', array(
    'acct_no', 'member_id', 'id_card', 'email', 'mbl'))).filter("epp_actv_mem_lvl='A1'"),
       spark.table('fdm_dpa.mls_member_base_attr'),
       spark.table('fdm_dpa.mls_member_base_date_info'),
       spark.table('fdm_dpa.mls_member_invest_action'),
       spark.table('fdm_dpa.mls_member_trade_action'),
       spark.table('fdm_dpa.mls_member_visit_action'),
       spark.table('fdm_dpa.mls_member_value_attr').filter(
           "is_bof_prch = 'N' and is_fin_user = 'N' and eg_mem_lvl in ('161000000130', '161000000140')")]


# 获取特征子集
get_df = lambda df: df.select([i for i in df.columns if i in ['acct_no', 'id'] + strColName + numColName])

# 移除acct_no
def _remove(ls):
    ls.remove('acct_no')
    return ls

df = dfs[0]
for _df in dfs[1:]:
    name = _remove(list(set(_df.columns).intersection(df.columns)))
    df = df.join(get_df(_df), 'acct_no').drop(*name) # 每个df都保留acct_no

df.write.saveAsTable('fbidm.yuanjie_deploy_20180108', mode='overwrite')
```
